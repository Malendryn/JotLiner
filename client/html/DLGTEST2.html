<!DOCTYPE html>
<html>
<head>
<title>Draggable List</title>
<style>
  ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
    width: 200px;
    position: relative;
  }

  li {
    padding: 10px;
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    margin-bottom: 5px;
    cursor: grab;
    position: relative;
  }

  li:active {
     cursor: grabbing;
  }

  li.dragging {
    opacity: 0.5;
    background-color: lightblue;
  }

  .placeholder {
    height: 2px;
    background-color: black;
    margin: 5px 0;
    position: absolute;
    width: 100%;
    top: auto;
    left: 0;
    z-index: 10;
  }
</style>
</head>
<body>

<ul id="myList">
  <li draggable="true">Item 1</li>
  <li draggable="true">Item 2</li>
  <li draggable="true">Item 3</li>
  <li draggable="true">Item 4</li>
</ul>

<script>
const list = document.getElementById('myList');
const listItems = list.querySelectorAll('li');
let draggedItem = null;
let placeholder;

function createPlaceholder() {
  if (!placeholder) {
    placeholder = document.createElement('div');
    placeholder.className = 'placeholder';
  }
}

listItems.forEach(item => {
  item.addEventListener('dragstart', handleDragStart);
  item.addEventListener('dragover', handleDragOver);
  item.addEventListener('drop', handleDrop);
  item.addEventListener('dragend', handleDragEnd);
});

function handleDragStart(event) {
  draggedItem = event.target;
  event.dataTransfer.effectAllowed = 'move';
  event.target.classList.add('dragging');
}

function handleDragOver(event) {
  event.preventDefault();
  event.dataTransfer.dropEffect = 'move';

  const target = event.target;

  if (target.nodeName === 'LI' && target !== draggedItem) {
    const bounding = target.getBoundingClientRect();
    const offset = event.clientY - bounding.top;

    createPlaceholder();

    if (offset > bounding.height / 2) {
      list.insertBefore(placeholder, target.nextSibling);
    } else {
      list.insertBefore(placeholder, target);
    }
  }
}

function handleDrop(event) {
  event.preventDefault();

  if (event.target !== draggedItem && event.target.nodeName === 'LI') {
      const targetIndex = Array.from(list.children).indexOf(event.target);
      const draggedIndex = Array.from(list.children).indexOf(draggedItem);

      if (draggedIndex < targetIndex) {
        list.insertBefore(draggedItem, event.target.nextSibling);
      } else {
         list.insertBefore(draggedItem, event.target);
      }
  }
  if (placeholder && placeholder.parentNode) {
    placeholder.parentNode.removeChild(placeholder);
  }
}

function handleDragEnd(event) {
  event.target.classList.remove('dragging');
  draggedItem = null;
  if (placeholder && placeholder.parentNode) {
    placeholder.parentNode.removeChild(placeholder);
  }
}
</script>

</body>
</html>
